<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Illandril's FoundryVTT Module Stats</title>
    <style>
      html,
      body {
        font-size: 14px;
      }

      #stats {
        display: grid;
        grid-template-columns: repeat(2, max-content);
        grid-gap: 1em;
      }

      #stats > div {
        padding: 0.5em;
        text-align: center;
        line-height: 0;
        display: inline-block;
      }

      #stats > div > * {
        margin: 1px;
        vertical-align: middle;
      }
    </style>
  </head>
  <body>
    <div id="stats"></div>
    <script>
      const container = document.getElementById("stats");
      const modules = [
        { key: "chat-enhancements" },
        { key: "grid-labels" },
        { key: "hotbar-uses" },
        { key: "inventory-sorter" },
        { key: "npc-quick-actions" },
        { key: "sheet-lockdown-worldbuilding" },
        { key: "sheet5e-lockdown" },
        { key: "third-pact" },
        { key: "tidy-module-settings" },
        { key: "token-hud-scale" },
        { key: "token-tooltips" },
        { key: "turn-marker" },
      ];
      const nameParams = `color=4b0000&style=flat-square&cacheSeconds=900`;
      const commonParams = `color=4b0000&style=flat-square&cacheSeconds=900`;
      const downloadParams = `color=d41f1f&style=flat-square&cacheSeconds=900`;
      for (let module of modules) {
        const modContainer = document.createElement("div");
        container.appendChild(modContainer);

        const name = document.createElement("img");
        name.src = `https://img.shields.io/badge/dynamic/json?${nameParams}&label=&query=%24.title&url=https%3A%2F%2Fgithub.com%2Fillandril%2FFoundryVTT-${module.key}%2Freleases%2Flatest%2Fdownload%2Fmodule.json`;
        modContainer.appendChild(name);

        modContainer.appendChild(document.createElement("br"));

        const latestReleaseVersion = document.createElement("img");
        latestReleaseVersion.src = `https://img.shields.io/github/v/release/illandril/FoundryVTT-${module.key}?${commonParams}&label=`;
        modContainer.appendChild(latestReleaseVersion);

        const latestReleaseDate = document.createElement("img");
        latestReleaseDate.src = `https://img.shields.io/github/release-date/illandril/FoundryVTT-${module.key}?${commonParams}&label=`;
        modContainer.appendChild(latestReleaseDate);

        modContainer.appendChild(document.createElement("br"));

        const latestDownloadCount = document.createElement("img");
        latestDownloadCount.src = `https://img.shields.io/github/downloads/illandril/FoundryVTT-${module.key}/latest/module.zip?${downloadParams}&label=D&suffix=x`;
        modContainer.appendChild(latestDownloadCount);

        const forgeInstalls = document.createElement("img");
        forgeInstalls.src = `https://img.shields.io/badge/dynamic/json?${downloadParams}&label=Forge%20Installs&query=package.installs&url=http%3A%2F%2Fforge-vtt.com%2Fapi%2Fbazaar%2Fpackage%2Fillandril-${module.key}&suffix=%25`;
        modContainer.appendChild(forgeInstalls);

        modContainer.appendChild(document.createElement("br"));

        const issuesLink = document.createElement("a");
        issuesLink.href = `https://github.com/illandril/FoundryVTT-${module.key}/issues`;
        modContainer.appendChild(issuesLink);

        const openIssues = document.createElement("img");
        openIssues.src = `https://img.shields.io/github/issues-raw/illandril/FoundryVTT-${module.key}?${commonParams}&label=Issues`;
        issuesLink.appendChild(openIssues);

        const coreVersion = document.createElement("img");
        coreVersion.src = `https://img.shields.io/badge/dynamic/json?${commonParams}&label=Foundry%20Version&query=%24.compatibility.verified&url=https%3A%2F%2Fgithub.com%2Fillandril%2FFoundryVTT-${module.key}%2Freleases%2Flatest%2Fdownload%2Fmodule.json`;
        modContainer.appendChild(coreVersion);
      }
    </script>
  </body>
</html>
